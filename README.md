# Libskycoin for Java

[![Build Status](https://travis-ci.org/libskycoin-dotnet.svg?branch=develop)](https://travis-ci.org/simelo/libskycoin-dotnet)

Java client library for Skycoin API. This library is a Java composed assembly generated with SWIG and OPENAPI to access Skycoin API from Java applications.

## Table of Contents

<!-- MarkdownTOC levels="1,2,3,4,5" autolink="true" bracket="round" -->

- [Installation](#installation)
- [Using the API](#usage)
  - [Naming](#naming)
  - [Parameters](#parameters)
    - [Handles](#handles)
    - [Byte Slices](#byte-slices)
    - [Structures](#structures)
    - [Fixed Size Arrays](#fixed-size-array)
    - [Other Slices](#other-slices)
    - [Memory Managemanet](#memory-management)
- [Make rules](#make-rules)
- [Development setup](#development-setup)
- [A Wrapper for Skycoin Api](#a-wrapper-for-skycoin-api)
  <!-- /MarkdownTOC -->


## Installation

## Install from sources

## Usage

### Naming

The exported function in Libskycoin Java have the following naming format: `SKY_package_func_name` where package is replace by the package where the original Skycoin function is and func_name is the name of the function. For example, `LoadConfig` function from `cli` package is called in Java `SKY_cli_LoadConfig`

### Parameters

All skycoin exported functions return an error object as the last of the return parameters. In Java error is return as an `uint` and it is the first return parameter. The rest of the parameters are returned in the same order.

Receivers in Skycoin are the first of the input parameters. Simple types, like integer, float, string will be used as the corresponding types in Java, except what act as pointers.

#### Handles

Some of Skycoin types are too complex to be exported to a scripting language. So, handles are used instead. Therefore all functions taking a complex type will receive a handle instead of the original Skycoin type. For example, having these functions exported from Skycoin:

```go
  func LoadConfig() (Config, error)
  func (c Config) FullWalletPath() string
```

Config is a struct type that is treated as a handle in Libskycoin Java . The usage in Java will be:

```java
// Some Java code
```

#### Byte slices

Parameters of type byte[] will treated as string . Example, this function in Skycoin:

```go
func (s ScryptChacha20poly1305) Encrypt(data, password []byte) ([]byte, error)
```

... should be invoked like this:

```java
// Invoking byte[] from Java
// Some code
```

#### Structures

Structures that are not exported as handles are treated like Java classes. In the previous example type ScryptChacha20poly1305 is created in Java like:

```java
// Creating ScryptChacha20poly1305
```

And passed as first parameter in call to `SKY_encrypt_ScryptChacha20poly1305_Encrypt`.

#### Fixed Sized Arrays

Parameters of fixed size array are wrapped in structures when called from Java.

Given these types in Skycoin and this exported function:

```go
  type PubKey [33]byte
  type SecKey [32]byte

  func GenerateDeterministicKeyPair(seed []byte) (PubKey, SecKey)
```

This is a way to use them to write assertions in Java:

```java
// Use assertions in Java
```

In the example above `pubkey` and `seckey` are objects of an structure type containing a field named `data` holding the corresponding instance of `PubKey` and `SecKey`. Something like:

```cpp
  cipher_PubKey struct{
    data [33]byte;
  } cipher_PubKey;

  cipher_SecKey struct{
    data [32]byte;
  } ;
```

#### Other Slices

Other slices of base type different from `byte` are indeed wrapped inside classes. Let's see how to call the following function:

```go
func GenerateDeterministicKeyPairs(seed []byte, n int) []SecKey
```

In Java this how it should be used to generate a deterministic sequence of pairs of public / private keys given a random seed:

```java
// Generate a random seed in Java
```

### Memory Management

Memory management is transparent to the user. Any object allocated inside the library is left to be managed by the Java garbage collector.

## Make Rules

The following `make` rules are available after `git checkout` of this repository. They all require [Skycoin](https://github.com/skycoin/skycoin) to be checked out as a `git submodule` of libskycoin Java .

- `build-libc`
  - Compiles skycoin C language library.
- `build-swig`
  - Creates the wrapper C code to generate the Java library.

### A Wrapper for Skycoin Api

This wrapper is Auto generated by openapi-generator directly from `Skycoin Api` code for version v0.25.1.

For further details of usage of `Java wrapper for Skycoin Api` see [Autogenerated documentation](./lib/skyapi/README.md)

### Specific Node Address

For use a specific node of Skycoin, you just need to create a instance of `ApiClient` passing the node address:

```java

```java

import org.openapitools.client.*;
import org.openapitools.client.auth.*;
import org.openapitools.client.model.*;
import org.openapitools.client.api.DefaultApi;

import java.io.File;
import java.util.*;

public class DefaultApiExample {

    public static void main(String[] args) {

        DefaultApi apiInstance = new DefaultApi();
        // This line change node address
        apiInstance.setBasePath("some node address");
        try {
            Object result = apiInstance.addressCount();
            System.out.println(result);
        } catch (ApiException e) {
            System.err.println("Exception when calling DefaultApi#addressCount");
            e.printStackTrace();
        }
    }
}

```
```

Then in `restSharpClient` you can use all methods related to Api Client.